!function(e){e.fn.zNice=function(c){function l(e){e.addClass("zNice-aBackground"),e.append('<span class="zNice-bgtl"></span><span class="zNice-bgtr"></span><span class="zNice-bgbl"></span><span class="zNice-bgbr"></span><span class="zNice-bgsl"></span><span class="zNice-bgsr"></span>')}var p=this;return p.selectItems=e(),"undefined"==typeof c&&(c={}),e.extend(c,{zValidate:!0,sExpandSelector:".zNice-select-text,.zNice-select-open"}),c.zValidate&&e(p).zValidate(),c.destroy?(n(p),!1):(p.isDisabled=function(e){e[0].disabled?e.disable():e.enable()},p.makeWrap=function(t){var a=e('<span class="zNice-wrap"></span>');if(t.before(a),t.appendTo(a),"undefined"!=typeof t.attr("class")){var s=t.attr("class").split(" ");e(s).each(function(e){this.length>0&&t.removeClass(s[e]),a.addClass(s[e])})}return a.prepend('<span class="zNice-bg"></span>'),t.focus(function(){a.addClass("zNice-focus")}).blur(function(){a.removeClass("zNice-focus")}),t.disable=function(e){this.zDisabled=!0,this.zWrap.addClass("zNice-disabled")},t.enable=function(e){this.zDisabled=!1,this.zWrap.removeClass("zNice-disabled")},a},p.tareaAdd=function(){var t=e(this),a=p.makeWrap(t);a.addClass("zNice-tArea"),c.aBackground&&l(a)},p.tinputAdd=function(){var t=e(this),a=p.makeWrap(t);a.addClass("zNice-tInput"),c.aBackground&&l(a),"undefined"!=typeof t.data("image")&&a.addClass("zNice-tInput-image").append('<span class="zNice-image"><span class="vfix"></span><img src="'+t.data("image")+'" alt=""/></span>'),"undefined"!=typeof t.data("color")&&a.addClass("zNice-tInput-color").append('<span class="zNice-color" style="background:'+t.data("color")+'"></span>'),"undefined"!=typeof t.data("ztype")&&"qInput"==t.data("ztype")&&(a.addClass("zNice-qInput"),a.removeClass("zNice-tInput"),a.wrapInner('<span class="zNice-tInput"></span>'),a.append('<span class="zNice-qInput-control zNice-qInput-inc"></span>').prepend('<span class="zNice-qInput-control zNice-qInput-dec"></span>'),e(".zNice-qInput-control",a).click(function(a){a.preventDefault(),e(this).is(".zNice-qInput-inc")?t.val(1*t.val()+1):t.val(t.val()>1?t.val()-1:1),t.change()}),t.keypress(function(t){t.preventDefault();var a="",s=String.fromCharCode(t.which),n=e(this).val()+s;for(i=0;i<=n.length;i++)1*n[i]>-1&&(a+=n[i]);a=a.substr(0,5),e(this).val(a),e(this).change(),0==e(this).val()&&e(this).val("1")}))},p.checkAdd=function(){var t=e(this);t.zWrap=p.makeWrap(t),t.zWrap.addClass("zNice-checkbox"),p.isDisabled(t),t.change(function(e){this.checked?t.zWrap.addClass("zNice-checked"):t.zWrap.removeClass("zNice-checked")}),this.checked&&t.zWrap.addClass("zNice-checked")},p.radioAdd=function(){var t=e(this),a=t.closest("form");t.zWrap=p.makeWrap(t),t.zWrap.addClass("zNice-radio"),p.isDisabled(t),t.change(function(){this.checked?(t.zWrap.addClass("zNice-checked"),e('input:radio[name="'+t.attr("name")+'"]',a).not(t).each(function(){var t=e(this).data("zNice-radio");t.attr("checked",!1),t.zWrap.removeClass("zNice-checked")})):t.zWrap.addClass("zNice-checked")}),this.checked&&t.zWrap.addClass("zNice-checked"),t.data("zNice-radio",t)},p.selectAdd=function(){var t=e(this),a=t.attr("multiple");if(t.zWrap=p.makeWrap(t),t.zWrap.addClass("zNice-select"),t.zOptions=new Array,a){t.zWrap.addClass("selectMultiple");var s=t.attr("data-placeholder");t.zText=e('<span class="zNice-select-text"><span class="zNice-select-item">'+s+"</span></span>")}else t.zText=e('<span class="zNice-select-text"></span>');t.zOpener=e('<span class="zNice-select-open"></span>'),t.zOptionsList=e('<ul class="zNice-select-list"></ul>'),t.zWrap.append(t.zText,t.zOpener,t.zOptionsList),p.isDisabled(t),t.expand=function(){t.zWrap.addClass("zNice-expanded"),t.zExpanded=!0},t.contract=function(){t.zWrap.removeClass("zNice-expanded"),t.zExpanded=!1},t.selectOption=function(s,i){var n=e(t.zOptions[s]).data("zNiceOption"),c=t.find("option").index(n.element);"undefined"==typeof i&&(i=!0),a?t.change():e(t.zOptions).removeClass("zNice-selected"),n.toggleClass("zNice-selected");var l=t.zOptionsList.find(".zNice-selected").length;a?t.zText.html('<span class="multipleText">Выбрано '+l+"</span>"):t.zText.html(e(t.zOptions[s]).html()),i&&t[0].selectedIndex!=c?(t[0].selectedIndex=c,t.change()):t[0].selectedIndex=c},t.updateOptions=function(){t.find("option").each(function(){t.addOption(this)}),a||t.selectOption(t[0].selectedIndex,!1)},t.addOption=function(s,i){"undefined"==typeof i&&(i=99999);var n=e("<li></li>");n.element=s,n.html('<span class="zNice-select-item">'+e(s).html()+"</span>"),"disabled"==e(s).data("disabled")&&n.addClass("zNice-disabled"),"undefined"!=typeof e(s).data("color")&&n.find(".zNice-select-item").addClass("zNice-select-color").prepend('<b class="zNice-color" style="background:'+e(s).data("color")+'"></b>'),"undefined"!=typeof e(s).data("image")&&n.find(".zNice-select-item").addClass("zNice-select-image").prepend('<span class="zNice-image"><img src="'+e(s).data("image")+'" alt="" /></span>'),0==i?t.zOptionsList.prepend(n):i>t.zOptions.length?t.zOptionsList.append(n):t.zOptionsList.find("li:eq("+i+")").prepend(n),n.click(function(){t.selectOption(e(t.zOptions).index(this)),a||p.selectHide()}),n.data("zNiceOption",n),t.zOptions.push(n[0])},t.zWrap.on("click",c.sExpandSelector,function(e){return t.zExpanded||t.zDisabled?p.selectHide():(p.selectHide(),t.expand()),e.preventDefault(),!1}),t.keydown(function(e){var a=this.selectedIndex;switch(e.keyCode){case 40:a<this.options.length-1&&t.selectOption(a+1);break;case 38:a>0&&t.selectOption(a-1);break;default:return}return!1}),t.updateOptions(),p.selectItems.push(t)},p.selectShow=function(){$selects=this.selectItems,$selects.each(function(){this.expand()})},p.selectHide=function(){$selects=this.selectItems,$selects.each(function(){this.contract()})},p.checkExternalClick=function(t){0===e(t.target).parents(".zNice-expanded").length&&p.selectHide()},e(document).mousedown(p.checkExternalClick),p.data("zNice")?!1:(p.data("zNice",p),this.each(function(){e("input:submit, input:reset, input:button,.button",this).each(s),e(".button",this).each(function(){e(this).mousedown(function(){return e(this).addClass("zNiceClicked"),!1})}),e(document).mouseup(function(){e(".button.zNiceClicked").removeClass("zNiceClicked")}),e("textarea",this).each(p.tareaAdd),e('input:text, input:password, input[type="email"]',this).each(p.tinputAdd),e("input:checkbox",this).each(p.checkAdd),e("input:radio",this).each(p.radioAdd),e("input:file",this).each(a),e("select",this).each(p.selectAdd),e(this).bind("reset",function(){var e,a=function(){t(e)};window.setTimeout(a,10)}),e(".zNiceHidden").css({opacity:0})})))};var t=function(t){var a;e(".zNiceSelectWrapper select",t).each(function(){a=this.selectedIndex<0?0:this.selectedIndex,e("ul",e(this).parent()).each(function(){e("a:eq("+a+")",this).click()})}),e(".zNiceCheckbox, .zNiceRadio",t).removeClass("zNiceChecked"),e("input:checkbox, input:radio",t).each(function(){e(this).is(":checked")&&e("a",e(this).parent()).addClass("zNiceChecked")})},a=function(){iclass=e(this).attr("class"),title=e(this).attr("title");var t=e(this).addClass("zNiceInput").wrap('<span class="zNiceInputWrapper fileupload '+("undefined"!=typeof iclass?iclass:"")+'"></span>').before('<span class="zNiceInputBg"><span class="zNiceInputLeft">'+("undefined"!=typeof e(this).attr("placeholder")?e(this).attr("placeholder"):"")+'</span><span class="zNiceInputRight"></span></span><span class="ubutton"><span class="ileft">'+("undefined"!=typeof title?title:"Обзор")+'</span><span class="iright"></span></span>'),a=t.parents(".zNiceInputWrapper");t.focus(function(){a.addClass("zNiceInputWrapper_hover")}).blur(function(){a.removeClass("zNiceInputWrapper_hover")}),t.change(function(){t.trigger("blur"),filename=e(this).val(),filename=filename.split("\\"),e(".zNiceInputBg .zNiceInputLeft",a).html(filename[filename.length-1])}),e(".ubutton",a).click(function(){t.trigger("click")})},s=function(){e(this).is(".button")?(value=e(this).html(),e(this).html('<span class="ileft">'+value+'</span><span class="iright"></span>')):(value=e(this).attr("value"),iclass=e(this).attr("class"),e(this).attr("class",""),e(this).attr("value",""),e(this).wrap('<span class="button '+("undefined"!=typeof iclass?iclass:"")+'"></span>'),e(this).parent().append('<span class="ileft">'+value+"</span>"),e(this).parent().append('<span class="iright"></span>'))},n=function(t){e(t).removeData("zNice").removeClass("zNice"),e(".zNice-wrap,.button,.zNiceInputWrapper",t).each(function(){var t=e(this);t.removeClass("zNice-select zNice-tInput zNice-qInput zNice-radio zNice-checkbox zNice-checked zNice-valid zNice-wrap  zNiceInputBg zNiceInputLeft zNiceInputWrapper zNiceInputRight   zNiceInput button ubutton fileupload ileft iright ");var a=t.attr("class"),s="undefined"==t.find(".ileft").text()?"Submit":s;t.find("input , select , textarea").clone().addClass(a).attr("value",s).appendTo(t.parent()),t.remove()})};e(function(){e(".zNice").zNice()})}(jQuery);